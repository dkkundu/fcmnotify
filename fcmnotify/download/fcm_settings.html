<script src="https://www.gstatic.com/firebasejs/7.14.6/firebase-app.js"></script> <script src="https://www.gstatic.com/firebasejs/7.14.6/firebase-messaging.js"></script><script>var firebaseConfig = { apiKey: "AIzaSyCoPZ1Sx_6A0Ok3tRBMB_wiPr-nv7HkBWg",authDomain:"dkkundu-f0cbd.firebaseapp.com",databaseURL: "https://dkkundu-f0cbd.asia-southeast1.firebasedatabase.app",projectId:"dkkundu-f0cbd" ,storageBucket:"dkkundu-f0cbd.appspot.com",messagingSenderId:"1010722653870",appId:"1:1010722653870:web:3252780fe60b2a8ceccf3f",measurementId:"G-SFTCBS1XYQ",usePublicVapidKey:"BAgYkqFrvCxd9nw7-nZdcAiIZ7MSgha9Mp4NMuabk2StW9npw0tkZQRot9ssWNccB1n8xoQIcNRFx9wZc-g2VPI" };firebase.initializeApp(firebaseConfig);const messaging=firebase.messaging();function IntitalizeFireBaseMessaging() {messaging.requestPermission().then(function () {console.log("Notification Permission");return messaging.getToken();}).then(function (token) {console.log("Token : "+token);sendToServer(token);}).catch(function (reason) {console.log(reason);});}messaging.onMessage(function (payload) {console.log(payload);const notificationOption={body:payload.notification.body,icon:payload.notification.icon};if(Notification.permission==="granted"){var notification=new Notification(payload.notification.title,notificationOption);notification.onclick=function (ev) {ev.preventDefault(); window.open(payload.notification.click_action,"_blank"); notification.close();}}});messaging.onTokenRefresh(function () {messaging.getToken().then(function (newtoken) {console.log("New Token : "+ newtoken);sendToServer(newtoken);}).catch(function (reason) {console.log(reason);}) });function sendToServer(token){$.ajax({url:"/save_fcm_token/",type:"POST",data:{token:token},}).done(function(response){if(response=="TOKEN SAVED"){console.log("Save")}else{ console.log("Error in Token Save")}});}IntitalizeFireBaseMessaging();</script>